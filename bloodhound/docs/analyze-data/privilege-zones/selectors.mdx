---
title: Selectors
description: Learn how to create, manage, and optimize selectors in Privilege Zones to enhance BloodHound's analysis.
---

<img noZoom src="/assets/enterprise-AND-community-edition-pill-tag.svg" alt="Applies to BloodHound Enterprise and CE" />

Selectors are rules that associate objects with zones and labels based on object ID, object relationships (expansion), and Cypher queries. BloodHound applies any selector changes during the next analysis operation.

**Zone** selectors provide a logical method of ensuring objects appear in the appropriate zone using either a Cypher query or by searching for an object ID. If an object has been added to multiple zones, the most critical zone in your defined hierarchy takes precedence.

**Label** selectors provide a flexible method of tagging objects in an environment. Objects can have multiple labels and you can use those labels to search and filter using Cypher in the **Explore** page.

### Types

Selectors are rules that automatically tag objects into zones or labels. Think of them as the "how" behind the tagging process.

* **Object selectors** target specific objects and their related objects through "expansion"
* **Cypher selectors** tag objects based on custom query results
* [**Default selectors**](https://github.com/SpecterOps/bloodhound-docs/blob/main//analyze-data/privilege-zones/default-selectors) are system-managed and tag critical objects automatically

## Selector expansion

Selectors automatically include related objects based on the type of object that you select, expanding through relationships to tag additional objects ([*some exceptions apply*](#tiered-object-control-and-exceptions)).

This "expansion" saves you time by tagging entire groups or organizational units at once. The following sections describe how different object types expand during the tagging process.

<Tip>You can interrupt automatic inclusion of additional objects into Privilege Zones by requiring manual certification of the additional objects. See [Certification](https://github.com/SpecterOps/bloodhound-docs/blob/main//analyze-data/privilege-zones/certification) to learn more.</Tip>

### Group-like expansion

Objects that behave like groups in Active Directory include all contained members within the zone/label. These include the following type (edge) relationships:

* Group ([`MemberOf`](https://github.com/SpecterOps/bloodhound-docs/blob/main//resources/edges/member-of))
* AZRole ([`AZHasRole`](https://github.com/SpecterOps/bloodhound-docs/blob/main//resources/edges/az-has-role), `AZRoleElligible`)
* AZGroup ([`AZMemberOf`](https://github.com/SpecterOps/bloodhound-docs/blob/main//resources/edges/az-member-of))

### Structured expansion

Objects that provide structural organization include all contained objects within the zone/label. These include the following type (edge) relationships:

* Domain ([`Contains`](https://github.com/SpecterOps/bloodhound-docs/blob/main//resources/edges/contains))
  <Note>For non-default selectors only.</Note>
* OU ([`Contains`](https://github.com/SpecterOps/bloodhound-docs/blob/main//resources/edges/contains)
* AZSubscription ([`AZContains`](https://github.com/SpecterOps/bloodhound-docs/blob/main//resources/edges/az-contains))
* AZManagementGroup ([`AZContains`](https://github.com/SpecterOps/bloodhound-docs/blob/main//resources/edges/az-contains))
* AZAdministrativeUnit ([`AZContains`](https://github.com/SpecterOps/bloodhound-docs/blob/main//resources/edges/az-contains))

### Tiered object control and exceptions

During the tagging process for zones, the final step involves tagging all objects that contain (or provide external control of) the selected objects.

For example, in Active Directory this means that all OUs, Containers, and GPOs that apply to any Tier Zero object are *also* tagged to the Tier Zero zone.

If any OUs or Containers are tagged in the last step of the tagging process only (not because you explicitly selected them), the process won't expand to tag other contained objects.

## Define a selector

The process and screens for creating and editing selectors is the same for zones and labels. Unless you're defining a selector as part of the zone or label creation process, be sure to specify a specific zone or label first.

<Steps>
  <Step title="Open the Privilege Zones page">
    <Tip>If you're defining a selector as part of the [zone or label](https://github.com/SpecterOps/bloodhound-docs/blob/main//analyze-data/privilege-zones/zones) creation process, skip to **Configure selector details** below.</Tip>

    1. In the left menu, click **Privilege Zones**.

    2. Click the **Zones** or **Labels** tab and select a specific zone or label.

       If you don't select a zone or label first, the new selector will be associated with the default zone or label selection when you open the page (top position in the **Zones** or **Labels** list).
  </Step>

  <Step title="Configure selector details">
    1. Click **Create Selector**.

    2. Enter all relevant information for the selector:

    <Warning>Review [selector expansion](https://github.com/SpecterOps/bloodhound-docs/blob/main//analyze-data/privilege-zones/selectors#selector-expansion) for more information about selector behavior.</Warning>

    | Field                   | Required? | Description                                                                |
    | ----------------------- | :-------: | -------------------------------------------------------------------------- |
    | Name                    |    Yes    | A unique name for the selector (e.g., PCI Assets)                          |
    | Description             |     No    | A brief description of the selector's purpose and scope (e.g., PCI assets) |
    | Selector Type           |    Yes    | The type of selector to use (e.g., Object ID or Cypher)                    |
    | Automatic Certification |     No    | **_[BHE Only]_** An option to choose how BloodHound [certifies](#certification) new objects |

    **Automatic Certification options**

    <Note>See [Certification](https://github.com/SpecterOps/bloodhound-docs/blob/main//analyze-data/privilege-zones/certification) to learn more.</Note>

    * **Initial members**: Only the first set of objects in the selector are certified automatically
    * **All members**: Every object, including those tied to initial members, is certified automatically
    * **Off**: All certification is manual

      <img src="/images/privzones/define-zone-selector.png" alt="Define a selector" title="Define a selector" style={{ width:"100%" }} />

      **Selector type configuration details**

      <Tabs>
        <Tab title="Object ID">
          1. In the **Object Selector** panel, type to search for an object by name or ID.

          2. Click the object to add it to the list of targeted objects.

             <img src="/images/privzones/objectid-selector-config.png" alt="Object ID selector configuration" title="Object ID selector configuration" style={{ width:"100%" }} />

             The **Sample Results** panel displays up to 200 sample results based on the selected object and [expansion](#selector-expansion) rules.
        </Tab>

        <Tab title="Cypher">
          1. Enter a Cypher query into the **Cypher Search** box.

          2. *(Optional)* To see sample results, click **Update Sample Results** above the Cypher query box. The first 200 results display in the **Sample Results** panel.

          3. *(Optional)* Click **View in Explore** to pivot to the **Explore** page and see results in the graph view.

             <img src="/images/privzones/cypher-selector-config.png" alt="Cypher selector configuration" title="Cypher selector configuration" style={{ width:"100%" }} />
        </Tab>
      </Tabs>

      Adding the following object types will automatically include (→) more objects according to the definition below

      * `OU/Container` → All objects contained in the OU/container
      * `Group` → All objects with membership in the Group
      * `AZResourceGroup`/`AZSubscription` → All objects contained in the RG/Sub
      * `AZGroup` → All objects with membership in the group
      * `AZRole` → All objects with role assignments (or eligibility)
  </Step>

  <Step title="Complete selector creation">
    Click **Save** to finish creating the selector.
  </Step>
</Steps>

## Edit or delete a selector

To edit or delete a selector, follow these steps:

<Note>Only users with the appropriate [permissions](https://github.com/SpecterOps/bloodhound-docs/blob/main//manage-bloodhound/auth/users-and-roles) can make changes. You cannot delete [default selectors](https://github.com/SpecterOps/bloodhound-docs/blob/main//analyze-data/privilege-zones/default-selectors).</Note>

<Steps>
  <Step title="Locate a selector">
    1. In the left menu, click **Privilege Zones**.

    2. Click the **Zones** or **Labels** tab and open the **Detail View**.

    3. Select the zone or label that contains the selector that you want to edit or delete and select it.

       <Tip>Alternatively, you can use the search bar to quickly find selector if you know the name.</Tip>
  </Step>

  <Step title="Edit or delete a selector">
    Choose one of the following options:

    <Tabs>
      <Tab title="Edit a selector" icon="edit">
        To edit a selector:

        <Note>Only users with the appropriate [permissions](https://github.com/SpecterOps/bloodhound-docs/blob/main//manage-bloodhound/auth/users-and-roles) can make changes. You cannot disable some [default selectors](https://github.com/SpecterOps/bloodhound-docs/blob/main//analyze-data/privilege-zones/default-selectors).</Note>

        1. Click **Edit** to open the selector details.

        2. Make any necessary changes to the selector configuration.

           For example, you can modify the selector's name, description, selector type, and certification settings.

           You can also disable or enable a selector by toggling the **Enabled** switch under the **Selector Status** section.

           <img src="/images/privzones/edit-selector.png" alt="Edit a selector" title="Edit a selector" style={{ width:"50%" }} />

        3. Click **Save Edits** to apply your changes.
      </Tab>

      <Tab title="Delete a selector" icon="trash-can">
        To delete a selector:

        1. Click <Icon icon="trash-can" /> **Delete Selector** at the bottom of the page

        2. Confirm your action in the dialog.

           <img src="/images/privzones/delete-selector-confirm.png" alt="Confirm deletion of a custom selector" title="Confirm deletion of a custom selector" style={{ width:"70%" }} />

        3. Click **Confirm** to delete the selector.
      </Tab>
    </Tabs>
  </Step>
</Steps>
