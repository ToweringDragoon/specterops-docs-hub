---
title: WriteAccountRestrictions
description: This edge indicates the principal has the ability to modify several properties on the target principal, most notably the msDS-AllowedToActOnBehalfOfOtherIdentity attribute. 
---

<img noZoom src="/assets/enterprise-AND-community-edition-pill-tag.svg" alt="Applies to BloodHound Enterprise and CE"/>


The ability to modify the msDS-AllowedToActOnBehalfOfOtherIdentity property allows an attacker to abuse resource-based constrained delegation to compromise the remote computer system. This property is a binary DACL that controls what security principals can pretend to be any domain user to the particular computer object.

This clip demonstrates how to abuse this edge:

<iframe id="youtube-4952" frameborder="0" allowfullscreen="" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" title="Player for 2 11 BloodHound Head to Tail Andy Robbins Rohan Vazarkar" width="100%" height="420" src="https://www.youtube.com/embed/fqYoOoghqdE?autoplay=0&amp;controls=0&amp;disablekb=1&amp;playsinline=1&amp;cc_load_policy=0&amp;cc_lang_pref=auto&amp" data-gtm-yt-inspected-6="true"></iframe>

## Abuse Info

See the AllowedToAct edge section for abuse info

## Opsec Considerations

See the AllowedToAct edge section for opsec considerations

## Edge Schema

Source: [User](https://github.com/SpecterOps/bloodhound-docs/blob/main//resources/nodes/user), [Group](https://github.com/SpecterOps/bloodhound-docs/blob/main//resources/nodes/group), [Computer](https://github.com/SpecterOps/bloodhound-docs/blob/main//resources/nodes/computer)   
Destination: [User](https://github.com/SpecterOps/bloodhound-docs/blob/main//resources/nodes/user), [Computer](https://github.com/SpecterOps/bloodhound-docs/blob/main//resources/nodes/computer)   
Traversable: **Yes**  

## References

* [https://attack.mitre.org/techniques/T1098/](https://attack.mitre.org/techniques/T1098/)
* [https://dirkjanm.io/abusing-forgotten-permissions-on-precreated-computer-objects-in-active-directory/](https://dirkjanm.io/abusing-forgotten-permissions-on-precreated-computer-objects-in-active-directory/)
* [https://docs.microsoft.com/en-us/windows/win32/adschema/r-user-account-restrictions](https://docs.microsoft.com/en-us/windows/win32/adschema/r-user-account-restrictions)
* [https://specterops.io/blog/2022/08/03/introducing-bloodhound-4-2-the-azure-refactor/](https://specterops.io/blog/2022/08/03/introducing-bloodhound-4-2-the-azure-refactor/)